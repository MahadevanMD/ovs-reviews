<html><head><meta charset="UTF-8"></head><body><pre>
ovs-benchmark(1)              Open vSwitch Manual             ovs-benchmark(1)



<b>N</b><b>A</b><b>M</b><b>E</b>
       ovs-benchmark - flow setup benchmark utility for Open vSwitch

<b>S</b><b>Y</b><b>N</b><b>O</b><b>P</b><b>S</b><b>I</b><b>S</b>
       <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> <b>l</b><b>a</b><b>t</b><b>e</b><b>n</b><b>c</b><b>y</b> <b>-</b><b>-</b><b>r</b><b>e</b><b>m</b><b>o</b><b>t</b><b>e</b> <u>i</u><u>p</u>[<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>] [<b>-</b><b>-</b><b>s</b><b>o</b><b>c</b><b>k</b><b>e</b><b>t</b><b>s</b> <u>n</u><u>s</u><u>o</u><u>c</u><u>k</u><u>s</u>]
                             [<b>-</b><b>-</b><b>b</b><b>a</b><b>t</b><b>c</b><b>h</b><b>e</b><b>s</b> <u>n</u><u>b</u><u>a</u><u>t</u><u>c</u><u>h</u><u>e</u><u>s</u>] [<b>-</b><b>-</b><b>l</b><b>o</b><b>c</b><b>a</b><b>l</b> [<u>i</u><u>p</u>][<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>]]

       <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> <b>r</b><b>a</b><b>t</b><b>e</b> <b>-</b><b>-</b><b>r</b><b>e</b><b>m</b><b>o</b><b>t</b><b>e</b> <u>i</u><u>p</u>[<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>] [<b>-</b><b>-</b><b>m</b><b>a</b><b>x</b><b>-</b><b>r</b><b>a</b><b>t</b><b>e</b> <u>r</u><u>a</u><u>t</u><u>e</u>]
                          [<b>-</b><b>-</b><b>t</b><b>i</b><b>m</b><b>e</b><b>o</b><b>u</b><b>t</b> <u>m</u><u>a</u><u>x</u><u>s</u><u>e</u><u>c</u><u>s</u>] [<b>-</b><b>-</b><b>s</b><b>o</b><b>c</b><b>k</b><b>e</b><b>t</b><b>s</b> <u>n</u><u>s</u><u>o</u><u>c</u><u>k</u><u>s</u>]
                          [<b>-</b><b>-</b><b>b</b><b>a</b><b>t</b><b>c</b><b>h</b><b>e</b><b>s</b> <u>n</u><u>b</u><u>a</u><u>t</u><u>c</u><u>h</u><u>e</u><u>s</u>] [<b>-</b><b>-</b><b>l</b><b>o</b><b>c</b><b>a</b><b>l</b> [<u>i</u><u>p</u>][<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>]]

       <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> <b>l</b><b>i</b><b>s</b><b>t</b><b>e</b><b>n</b> [<b>-</b><b>-</b><b>l</b><b>o</b><b>c</b><b>a</b><b>l</b> [<u>i</u><u>p</u>]<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>]

       <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> <b>h</b><b>e</b><b>l</b><b>p</b>

<b>D</b><b>E</b><b>S</b><b>C</b><b>R</b><b>I</b><b>P</b><b>T</b><b>I</b><b>O</b><b>N</b>
       <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> tests the performance of Open vSwitch flow setup by  set‐
       ting  up  a  number of TCP connections and measuring the time required.
       It can also be used with the Linux bridge or without any bridging soft‐
       ware,  which  allows  one  to measure the bandwidth and latency cost of
       bridging.

       Each <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> command is described separately below.

<b>T</b><b>h</b><b>e</b> <b>`</b><b>`</b><b>l</b><b>a</b><b>t</b><b>e</b><b>n</b><b>c</b><b>y</b><b>'</b><b>'</b> <b>c</b><b>o</b><b>m</b><b>m</b><b>a</b><b>n</b><b>d</b>
       This command initiates <u>n</u><u>s</u><u>o</u><u>c</u><u>k</u><u>s</u> TCP  connections  (by  default,  100)  as
       quickly  as  possible,  waits  for each one to complete with success or
       failure, and prints a bar chart of completion times on standard output,
       followed by a summary line.  Each line in the bar chart lists a time to
       connection completion in milliseconds followed by a number of  <b>.</b>  or  <b>!</b>
       symbols,  one  for each TCP connection that completed in that many mil‐
       liseconds.  A successful connection prints a  <b>.</b>,  and  an  unsuccessful
       connection  (e.g.  to a port on which no process is listening) prints a
       <b>!</b>.

       If <u>n</u><u>b</u><u>a</u><u>t</u><u>c</u><u>h</u><u>e</u><u>s</u> is given, the entire procedure is  repeated  the  specified
       number of times.  Only a single summary line is printed at the end.

       Results  vary  widely  based  on  the number of sockets and whether the
       remote host is listening for connections on the specified ports.   With
       a small number of sockets, all connection times typically remain within
       a handful of milliseconds.  As the number  of  sockets  increases,  the
       distribution  of  connection  times  clusters  around  the  sending TCP
       stack's SYN retransmission interval.   (This  pattern  occurs  with  or
       without Open vSwitch on the network path.)

<b>T</b><b>h</b><b>e</b> <b>`</b><b>`</b><b>r</b><b>a</b><b>t</b><b>e</b><b>'</b><b>'</b> <b>c</b><b>o</b><b>m</b><b>m</b><b>a</b><b>n</b><b>d</b>
       This  command  initiates  <u>n</u><u>s</u><u>o</u><u>c</u><u>k</u><u>s</u>  TCP  connections (by default, 100) as
       quickly as possible (limited by <u>m</u><u>a</u><u>x</u><u>r</u><u>a</u><u>t</u><u>e</u>, if <b>-</b><b>-</b><b>m</b><b>a</b><b>x</b><b>-</b><b>r</b><b>a</b><b>t</b><b>e</b>  is  specified).
       Each  time  a  connection  completes with success or failure, it closes
       that connection and initiates a new one.  It continues to do so  either
       forever  or,  if  <b>-</b><b>-</b><b>t</b><b>i</b><b>m</b><b>e</b><b>o</b><b>u</b><b>t</b>  is  specified,  until <u>m</u><u>a</u><u>x</u><u>s</u><u>e</u><u>c</u><u>s</u> seconds have
       elapsed.  During the test, it prints  statistics  about  time  elapsed,
       successful and unsuccessful connections, and the average number of com‐
       pleted (succeeded or failed) connections per second over the run.

       Without <b>-</b><b>-</b><b>m</b><b>a</b><b>x</b><b>-</b><b>r</b><b>a</b><b>t</b><b>e</b>, the <b>r</b><b>a</b><b>t</b><b>e</b> command  measures  the  maximum  sustained
       flow  setup rate for an Open vSwitch instance.  This naturally tends to
       drive <b>o</b><b>v</b><b>s</b><b>-</b><b>v</b><b>s</b><b>w</b><b>i</b><b>t</b><b>c</b><b>h</b><b>d</b> CPU usage to 100% on the host receiving the traffic.

       When <b>-</b><b>-</b><b>m</b><b>a</b><b>x</b><b>-</b><b>r</b><b>a</b><b>t</b><b>e</b> is specified with a value below the maximum  rate  that
       an Open vSwitch instance can handle, then <b>r</b><b>a</b><b>t</b><b>e</b> can also be used to mea‐
       sure the kernel and userspace CPU cost of flow setups at specific  flow
       rates.

       Results  tend  to fluctuate greatly for the first few seconds of a run,
       then settle down.  The displayed average is calculated over the  entire
       run  and  so tends to converge asymptotically on the ``correct'' value.
       To converge more quickly, try running for 5 to 10 seconds, then killing
       and restarting the run.

<b>T</b><b>h</b><b>e</b> <b>`</b><b>`</b><b>l</b><b>i</b><b>s</b><b>t</b><b>e</b><b>n</b><b>'</b><b>'</b> <b>c</b><b>o</b><b>m</b><b>m</b><b>a</b><b>n</b><b>d</b>
       This command listens on one or more TCP ports for incoming connections.
       It accepts connections and immediately closes them.  It can  be  paired
       with  the  <b>r</b><b>a</b><b>t</b><b>e</b> or <b>l</b><b>a</b><b>t</b><b>e</b><b>n</b><b>c</b><b>y</b> commands for observing effects of successful
       vs. unsuccessful TCP connections.

       It is easier to reproduce  and  interpret  <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b>  results  when
       there is no listener (see <b>N</b><b>O</b><b>T</b><b>E</b><b>S</b> below).

<b>T</b><b>h</b><b>e</b> <b>`</b><b>`</b><b>h</b><b>e</b><b>l</b><b>p</b><b>'</b><b>'</b> <b>c</b><b>o</b><b>m</b><b>m</b><b>a</b><b>n</b><b>d</b>
       Prints a usage message and exits successfully.

<b>O</b><b>P</b><b>T</b><b>I</b><b>O</b><b>N</b><b>S</b>
       <b>-</b><b>r</b> <u>i</u><u>p</u>[<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>]
       <b>-</b><b>-</b><b>r</b><b>e</b><b>m</b><b>o</b><b>t</b><b>e</b> <u>i</u><u>p</u>[<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>]
              This  option,  required  on <b>l</b><b>a</b><b>t</b><b>e</b><b>n</b><b>c</b><b>y</b> and <b>r</b><b>a</b><b>t</b><b>e</b> commands, minimally
              specifies the remote host to connect to (as an IP address or DNS
              name) as <u>i</u><u>p</u>.

              A TCP port or range of ports (separated by <b>-</b>) may also be speci‐
              fied.  If a range is specified then each port in  the  range  is
              used  in round-robin order.  The default port is 6630 if none is
              specified.

       <b>-</b><b>l</b> [<u>i</u><u>p</u>][<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>]
       <b>-</b><b>-</b><b>l</b><b>o</b><b>c</b><b>a</b><b>l</b> [<u>i</u><u>p</u>][<b>:</b><u>p</u><u>o</u><u>r</u><u>t</u><u>s</u>]
              On the <b>l</b><b>a</b><b>t</b><b>e</b><b>n</b><b>c</b><b>y</b> and <b>r</b><b>a</b><b>t</b><b>e</b>, without this option,  outgoing  connec‐
              tions  will  not  bind a specific TCP port.  The local TCP stack
              will pick a local TCP port to bind.  When this option is  speci‐
              fied, the specified port or range of ports will be used in turn.
              (If a port range is specified on both <b>-</b><b>-</b><b>l</b><b>o</b><b>c</b><b>a</b><b>l</b> and <b>-</b><b>-</b><b>r</b><b>e</b><b>m</b><b>o</b><b>t</b><b>e</b>, then
              each local port in its range will be used before the remote port
              is incremented to the next port in its range.)

              On the <b>l</b><b>i</b><b>s</b><b>t</b><b>e</b><b>n</b> command, this option specifies the local  port  or
              ports  and  IP  addresses on which to listen.  If it is omitted,
              port 6630 on any IP address is used.

       <b>-</b><b>s</b> <u>n</u><u>s</u><u>o</u><u>c</u><u>k</u><u>s</u>
       <b>-</b><b>-</b><b>s</b><b>o</b><b>c</b><b>k</b><b>e</b><b>t</b><b>s</b> <u>n</u><u>s</u><u>o</u><u>c</u><u>k</u><u>s</u>
              For <b>l</b><b>a</b><b>t</b><b>e</b><b>n</b><b>c</b><b>y</b>, sets the number  of  connections  to  initiate  per
              batch.   For  <b>r</b><b>a</b><b>t</b><b>e</b>,  sets  the number of outstanding connections
              attempts to maintain at any given time.  The default is 100.

       <b>-</b><b>b</b> <u>n</u><u>b</u><u>a</u><u>t</u><u>c</u><u>h</u><u>e</u><u>s</u>
       <b>-</b><b>-</b><b>b</b><b>a</b><b>t</b><b>c</b><b>h</b><b>e</b><b>s</b> <u>n</u><u>b</u><u>a</u><u>t</u><u>c</u><u>h</u><u>e</u><u>s</u>
              For <b>l</b><b>a</b><b>t</b><b>e</b><b>n</b><b>c</b><b>y</b>, sets the number of times to initiate and  wait  for
              all of the connections to complete.  The default is 1.

       <b>-</b><b>c</b> <u>m</u><u>a</u><u>x</u><u>r</u><u>a</u><u>t</u><u>e</u>
       <b>-</b><b>-</b><b>m</b><b>a</b><b>x</b><b>-</b><b>r</b><b>a</b><b>t</b><b>e</b> <u>m</u><u>a</u><u>x</u><u>r</u><u>a</u><u>t</u><u>e</u>
              For  <b>r</b><b>a</b><b>t</b><b>e</b>,  caps  the  maximum rate at which connections will be
              attempted to <u>m</u><u>a</u><u>x</u><u>r</u><u>a</u><u>t</u><u>e</u> connections per second.  By  default  there
              is no limit.

       <b>-</b><b>T</b> <u>m</u><u>a</u><u>x</u><u>s</u><u>e</u><u>c</u><u>s</u>
       <b>-</b><b>-</b><b>t</b><b>i</b><b>m</b><b>e</b><b>o</b><b>u</b><b>t</b> <u>m</u><u>a</u><u>x</u><u>s</u><u>e</u><u>c</u><u>s</u>
              For  <b>r</b><b>a</b><b>t</b><b>e</b>,  stops  the  benchmark  after  <u>m</u><u>a</u><u>x</u><u>s</u><u>e</u><u>c</u><u>s</u>  seconds  have
              elapsed.  By default, the benchmark continues until  interrupted
              by a signal.

<b>N</b><b>O</b><b>T</b><b>E</b><b>S</b>
       <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b>  uses  standard POSIX socket calls for network access, so
       it shares the strengths and limitations of TCP/IP and  its  implementa‐
       tions in the local and remote TCP/IP stacks.  Particularly, TCP and its
       implementations limit the number of  successfully  completed  and  then
       closed  TCP  connections.   This means that <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> tests tend to
       slow down if run for long intervals or with large numbers of sockets or
       batches,  if  the remote system is listening on the port or ports being
       contacted.  The problem does not occur when the remote  system  is  not
       listening.   <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> results are therefore much more reliable and
       repeatable when the remote system is not listening on the port or ports
       being  contacted.   Even a single listening socket (e.g. range of ports
       8000 to 9000 with one listener on port 8080)  can  cause  anomalies  in
       results.

       Be  sure that the remote TCP/IP stack's firewall allows the benchmark's
       traffic to be processed.  For Open vSwitch benchmarking  purposes,  you
       might want to disable the firewall with, e.g., <b>i</b><b>p</b><b>t</b><b>a</b><b>b</b><b>l</b><b>e</b><b>s</b> <b>-</b><b>F</b>.

       <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b>  is  single-threaded.   A  multithreaded process might be
       able to initiate connections more quickly.

       A TCP connection consists of two flows (one in each direction), so mul‐
       tiply  the TCP connection statistics that <b>o</b><b>v</b><b>s</b><b>-</b><b>b</b><b>e</b><b>n</b><b>c</b><b>h</b><b>m</b><b>a</b><b>r</b><b>k</b> reports by 2 to
       get flow statistics.



Open vSwitch                        2.3.90                    ovs-benchmark(1)
</pre></body></html>
